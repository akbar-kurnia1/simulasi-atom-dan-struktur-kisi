<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Atom dan Struktur Kisi Atom</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat pustaka Three.js dan OrbitControls secara global -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <!-- Menghubungkan ke file CSS eksternal -->
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="w-screen h-screen m-0 p-0">

    <!-- Canvas untuk render 3D -->
    <canvas id="bg"></canvas>

    <!-- Panel Judul -->
    <div id="title-panel" class="panel absolute top-2 left-2 right-2 md:top-4 md:left-4 md:right-auto md:w-auto p-3 md:p-4 rounded-lg shadow-lg z-10">
        <div class="flex items-center gap-2 md:gap-4">
            <h1 id="main-title" class="text-xl md:text-2xl font-bold">Simulasi Atom</h1>
            <button id="mode-switch-btn" class="btn btn-secondary text-xs px-2 py-1">Mode Kisi</button>
        </div>
        <p id="main-subtitle" class="text-xs md:text-sm">Visualisasikan struktur atom secara interaktif.</p>
    </div>
    
    <!-- === UI UNTUK MODE SIMULASI ATOM === -->
    <div id="atom-sim-ui">
        <!-- Panel Kontrol Samping (Ikon) -->
        <div id="side-controls-panel" class="absolute left-2 md:left-4 top-1/2 -translate-y-1/2 flex flex-col gap-3 z-10">
            <button id="periodic-table-btn" class="icon-btn" aria-label="Buka Tabel Periodik">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                </svg>
            </button>
            <button id="structure-toggle-btn" class="icon-btn" aria-label="Toggle Struktur Inti Kubik">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
                </svg>
            </button>
             <button id="expansion-toggle-btn" class="icon-btn" aria-label="Toggle Ekspansi Inti">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 1v4m0 0h-4m4 0l-5-5" />
                </svg>
            </button>
            <button id="view-toggle-btn" class="icon-btn" aria-label="Toggle Tampilan 2D/3D">
                <span id="view-toggle-text" class="font-bold text-sm select-none">2D</span>
            </button>
            <button id="theme-toggle-btn" class="icon-btn" aria-label="Toggle Tema Gelap/Terang">
                <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>
            <button id="zoom-in-btn" class="icon-btn" aria-label="Zoom In">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3h-6" />
                </svg>
            </button>
            <button id="zoom-out-btn" class="icon-btn" aria-label="Zoom Out">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7" />
                </svg>
            </button>
        </div>

        <!-- Tombol untuk menampilkan kembali panel info -->
        <button id="show-info-btn" class="icon-btn absolute top-44 sm:top-40 md:top-4 right-4 z-10 hidden" aria-label="Tampilkan Informasi">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        </button>

        <!-- Panel Informasi Atom -->
        <div id="info-panel" class="panel absolute top-44 sm:top-40 md:top-4 right-2 md:right-4 p-3 md:p-4 rounded-lg shadow-lg w-auto md:w-72 z-10">
            <div id="info-header" class="flex justify-between items-center cursor-pointer">
                <h2 class="text-base md:text-lg font-bold">Informasi Atom</h2>
                <svg id="info-arrow" class="w-6 h-6 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
                </svg>
            </div>
            <div id="info-content" class="mt-2 pt-2 border-t" style="border-color: var(--panel-border-color);">
                <div class="space-y-1 text-sm">
                    <p><strong>Unsur:</strong> <span id="element-name"></span></p>
                    <p><strong>Nomor Atom (Z):</strong> <span id="atomic-number"></span></p>
                    <p><strong>Nomor Massa (A):</strong> <span id="mass-number"></span></p>
                    <p><strong>Muatan:</strong> <span id="charge"></span></p>
                    <p><strong>Isotop:</strong> <span id="isotope-name"></span></p>
                    <!--belom fix-->
                    <p id="symbol-origin-row" class="hidden"><strong>Asal Simbol:</strong> <span id="element-symbol-origin"></span></p>

                    <p><strong>Stabilitas Inti:</strong> <span id="core-stability" class="font-bold"></span></p>
                    <div class="pt-2 border-t mt-2" style="border-color: var(--panel-border-color);">
                        <p><strong>Wujud:</strong> <span id="element-phase"></span></p>
                        <p><strong>Kegunaan:</strong> <span id="element-usage"></span></p>
                    </div>
                     <div class="pt-2 border-t mt-2" style="border-color: var(--panel-border-color);">
                        <h3 class="font-bold text-sm mb-1" style="color: var(--text-color);">Konfigurasi Elektron</h3>
                        <p id="electron-config-string" class="text-xs break-words"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Panel Kontrol Utama -->
        <div id="controls-panel" class="panel absolute bottom-8 left-0 right-0 md:left-1/2 md:-translate-x-1/2 md:bottom-8 md:w-auto p-2 md:p-4 rounded-none md:rounded-lg shadow-lg flex flex-col sm:flex-row gap-2 md:gap-4 items-center z-10">
            <div class="grid grid-cols-3 gap-2">
                <button id="add-proton" class="btn text-xs sm:text-sm">+ Proton</button>
                <button id="add-neutron" class="btn btn-secondary text-xs sm:text-sm">+ Neutron</button>
                <button id="add-electron" class="btn text-xs sm:text-sm">+ Elektron</button>
                <button id="remove-proton" class="btn btn-danger text-xs sm:text-sm">- Proton</button>
                <button id="remove-neutron" class="btn btn-danger text-xs sm:text-sm">- Neutron</button>
                <button id="remove-electron" class="btn btn-danger text-xs sm:text-sm">- Elektron</button>
            </div>
            <div class="sm:border-l border-gray-600 sm:pl-4 flex flex-row sm:flex-grow gap-2 w-full sm:w-auto">
                 <button id="toggle-nucleus" class="btn btn-secondary w-full text-xs sm:text-sm">Pisahkan Inti</button>
                 <button id="reset-atom" class="btn btn-danger w-full text-xs sm:text-sm">Reset</button>
            </div>
        </div>

         <!-- Kontrol Slider Ekspansi Atom -->
        <div id="atom-expansion-slider-container" class="panel absolute bottom-28 md:bottom-32 left-1/2 -translate-x-1/2 w-4/5 max-w-xs p-2 rounded-lg shadow-lg z-10 hidden opacity-0 slider-container">
            <label for="atom-expansion-slider" class="text-xs text-center block mb-1">Jarak Inti</label>
            <input type="range" id="atom-expansion-slider" min="1" max="4" step="0.1" value="1">
        </div>
    </div>
    
    <!-- === UI UNTUK MODE STRUKTUR KISI === -->
    <div id="lattice-sim-ui" class="hidden">
        <!-- Tombol untuk menampilkan kembali panel kontrol kisi -->
        <button id="show-lattice-controls-btn" class="icon-btn absolute top-28 left-4 z-10 hidden" aria-label="Tampilkan Kontrol Kisi">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
        </button>

        <!-- Panel Kontrol Kiri -->
        <div id="lattice-controls-panel" class="panel absolute top-44 sm:top-40 md:top-28 left-2 md:left-4 p-4 rounded-lg shadow-lg w-auto z-10">
             <div id="lattice-controls-header" class="flex justify-between items-center cursor-pointer mb-4">
                <h2 class="text-base font-bold">Kontrol Kisi</h2>
                <svg id="lattice-controls-arrow" class="w-6 h-6 transition-transform transform -rotate-180" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
                </svg>
             </div>
             <div id="lattice-controls-content" class="border-t pt-4" style="border-color: var(--panel-border-color);">
                <div id="lattice-controls" class="space-y-4">
                    <div>
                        <label for="lattice-type-select" class="block text-sm font-medium mb-2">Struktur Kisi</label>
                        <select id="lattice-type-select">
                            <option value="sc">Simple Cubic</option>
                            <option value="bcc">Body-Centered Cubic</option>
                            <option value="fcc">Face-Centered Cubic</option>
                            <option value="hcp">Hexagonal Close-Packed</option>
                        </select>
                    </div>
                    <div id="lattice-display-controls" class="space-y-2">
                        <label>
                            <input type="radio" name="lattice-display" value="unit-cell" checked>
                            <span class="ml-2 text-sm">Unit Cell</span>
                        </label>
                         <label>
                            <input type="radio" name="lattice-display" value="contribution">
                            <span class="ml-2 text-sm">Kontribusi Atom</span>
                        </label>
                        <label>
                            <input type="radio" name="lattice-display" value="8-cells">
                            <span class="ml-2 text-sm">Tampilan 8 Sel</span>
                        </label>
                        <label>
                            <input type="radio" name="lattice-display" value="27-cells">
                            <span class="ml-2 text-sm">Tampilan 27 Sel</span>
                        </label>
                        <label>
                            <input type="radio" name="lattice-display" value="layer">
                            <span class="ml-2 text-sm">Layer</span>
                        </label>
                        <label>
                            <input type="radio" name="lattice-display" value="coordination">
                            <span class="ml-2 text-sm">Koordinasi</span>
                        </label>
                        <div id="coordination-options" class="hidden ml-6 mt-2 space-y-1">
                            <label class="flex items-center text-xs">
                                <input type="radio" name="coordination-view" value="corner" checked>
                                <span class="ml-2">Amati dari Sudut</span>
                            </label>
                            <label class="flex items-center text-xs">
                                <input type="radio" name="coordination-view" value="face">
                                <span class="ml-2">Amati dari Sisi</span>
                            </label>
                        </div>
                        <label>
                            <input type="radio" name="lattice-display" value="single">
                            <span class="ml-2 text-sm">Single</span>
                        </label>
                    </div>
                    <button id="toggle-outline-btn" class="btn btn-secondary w-full text-xs sm:text-sm !py-1">Sembunyikan Sel</button>
                </div>
             </div>
        </div>
        
        <!-- Tombol untuk menampilkan kembali panel info kisi -->
        <button id="show-lattice-info-btn" class="icon-btn absolute top-4 right-4 z-10 hidden" aria-label="Tampilkan Informasi Kisi">
             <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        </button>

        <!-- Panel Informasi Kisi -->
        <div id="lattice-info-panel" class="panel absolute top-44 sm:top-40 md:top-4 right-2 md:right-4 p-3 md:p-4 rounded-lg shadow-lg w-auto md:w-72 z-10">
            <div id="lattice-info-header" class="flex justify-between items-center cursor-pointer">
                <h2 class="text-base md:text-lg font-bold">Informasi Kisi</h2>
                <svg id="lattice-info-arrow" class="w-6 h-6 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
                </svg>
            </div>
            <div id="lattice-info-content" class="mt-2 pt-2 border-t" style="border-color: var(--panel-border-color);">
                <div class="space-y-1 text-sm">
                    <p><strong>Bilangan Koordinasi:</strong> <span id="lattice-coordination-number"></span></p>
                    <p><strong>Faktor Tumpukan Atom (APF):</strong> <span id="lattice-apf"></span></p>
                    <p><strong>Parameter Kisi (a, c):</strong> <span id="lattice-parameter-relation"></span></p>
                </div>
                <div id="lattice-contribution-section" class="mt-2 pt-2 border-t" style="border-color: var(--panel-border-color);">
                     <h3 class="font-bold text-sm mb-1" style="color: var(--text-color);">Kontribusi Atom</h3>
                     <div class="space-y-1 text-xs">
                        <p id="contribution-corners"></p>
                        <p id="contribution-faces"></p>
                        <p id="contribution-body"></p>
                        <p id="contribution-total" class="font-bold pt-1 border-t" style="border-color: var(--panel-border-color);"></p>
                     </div>
                </div>
            </div>
        </div>

        <!-- Panel Kontrol Bawah (Slider Ekspansi Kisi) -->
        <div id="lattice-expansion-slider-container" class="panel absolute bottom-8 left-1/2 -translate-x-1/2 w-4/5 max-w-xs p-2 rounded-lg shadow-lg z-10 slider-container">
            <label for="lattice-expansion-slider" class="text-xs text-center block mb-1">Ekspansi</label>
            <input type="range" id="lattice-expansion-slider" min="0.5" max="2.0" step="0.01" value="1.0">
        </div>
    </div>

    
    <!-- Tombol About di kanan bawah -->
    <button id="about-btn" class="icon-btn absolute right-2 md:right-4 bottom-8 z-10" aria-label="Buka Tentang">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
    </button>
    
    <!-- Tabel Periodik -->
    <div id="periodic-table-modal" class="modal hidden fixed inset-0 z-20 flex justify-center items-center transition-opacity duration-300 p-4">
        <div id="periodic-table-backdrop" class="absolute inset-0"></div>
        <div id="periodic-table-container" class="modal-container p-4 rounded-lg shadow-lg relative w-full max-w-7xl">
             <h3 class="text-lg font-bold text-center mb-4">Pilih Unsur</h3>
             <!-- PERBAIKAN BUG: Wrapper untuk scroll horizontal di HP -->
             <div class="overflow-x-auto">
                <div id="periodic-table-grid" class="grid gap-1 text-center text-xs min-w-[700px]" style="grid-template-columns: repeat(18, minmax(0, 1fr));">
                    <!-- Grid akan diisi oleh JavaScript -->
                </div>
             </div>
        </div>
    </div>
    
    <!-- Peringatan Kinerja -->
    <div id="performance-warning-modal" class="modal hidden fixed inset-0 z-30 flex justify-center items-center p-4">
        <div class="modal-container p-6 rounded-lg shadow-lg text-center w-full max-w-sm">
            <h3 class="text-xl font-bold mb-2">Peringatan Kinerja</h3>
            <p class="text-sm mb-4">Unsur yang Anda pilih sangat besar. Ini mungkin akan memperlambat kinerja perangkat Anda karena perlu merender banyak partikel 3D.</p>
            <div class="flex gap-4 mt-6">
                <button id="cancel-warning-btn" class="btn btn-secondary w-full">Batal</button>
                <button id="continue-warning-btn" class="btn w-full">Lanjutkan</button>
            </div>
        </div>
    </div>

    <!-- Tentang -->
    <div id="about-modal" class="modal hidden fixed inset-0 z-30 flex justify-center items-center p-4">
        <div id="about-modal-backdrop" class="absolute inset-0"></div>
        <div class="modal-container p-6 rounded-lg shadow-lg text-left w-full max-w-md relative">
            <button id="close-about-btn" class="absolute top-3 right-3 icon-btn w-8 h-8 flex items-center justify-center">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <h3 class="text-xl font-bold mb-4" style="color: var(--text-color);">Tentang</h3>
            <div class="space-y-2 text-sm">
                <p class="font-bold" style="color: var(--text-color);">Kelompok 7 Mata Kuliah Fisika Zat Padat</p>
                <ul class="list-disc list-inside space-y-1">
                    <li>Akbar Kurniawan (08021282328046)</li>
                    <li>Hanifati Nabillah Amru (08021182328010)</li>
                    <li>Nahdah Isma Rosalina (08021182328002)</li>
                    <li>Rinche Lianita D.P.A (08021282328062)</li>
                </ul>
            </div>
            <div class="mt-6 pt-4 border-t space-y-2" style="border-color: var(--panel-border-color);">
                 <p class="font-bold text-sm" style="color: var(--text-color);">Catatan Developer</p>
                 <p class="text-xs">
                    Website ini dikembangkan menggunakan HTML, CSS, dan bahasa pemrograman JavaScript. Terima kasih kepada anggota Kelompok 7 yang telah memberikan masukan dan arahan sehingga proyek ini berhasil diselesaikan.
                 </p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="absolute bottom-2 w-full text-center text-xs z-0">
        <p id="footer-text" class="opacity-60">&copy; 2025 Akbar-Kurnia1. All rights reserved.</p>
    </footer>

    <!-- Menghubungkan ke file JavaScript eksternal -->
    <script src="script.js"></script>
</body>
</html>

